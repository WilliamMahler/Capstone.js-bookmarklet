<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Disassemble bytes directly from any webpage by William Mahler</title>
    <script>
    	
    	
// Create the XHR object.
function createCORSRequest(method, url) {
  var xhr = new XMLHttpRequest();
  if ("withCredentials" in xhr) {
    // XHR for Chrome/Firefox/Opera/Safari.
    xhr.open(method, url, true);
  } else if (typeof XDomainRequest != "undefined") {
    // XDomainRequest for IE.
    xhr = new XDomainRequest();
    xhr.open(method, url);
  } else {
    // CORS not supported.
    xhr = null;
  }
  return xhr;
}


    	/*
    	var CDNLoadTime = 0;
    	var masterDOMReadyDelay = performance.now();

    	function loadBasicEdit(){
    		masterDOMReadyDelay = performance.now() - masterDOMReadyDelay;
    		CDNLoadTime = performance.now();
	    	var jsCode = document.createElement('script');
	    	//jsCode.setAttribute('src', 'https://basicedit.com/changes.js'); //production
	    	jsCode.setAttribute('src', 'https://s3.amazonaws.com/basicedit/changes.js'); //development
	    	document.body.appendChild(jsCode);
    	}

			document.addEventListener('DOMContentLoaded', loadBasicEdit, false);
			*/
    </script>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="google-site-verification" content="wZH-nf79AZFJ5L7YgQsqhDFErus2b3XN9I18MwxRBkA" />
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
	  <link rel="apple-touch-icon" sizes="57x57" href="/Capstone.js-bookmarklet/icons/apple-icon-57x57.png">
	  <link rel="apple-touch-icon" sizes="60x60" href="/Capstone.js-bookmarklet/icons/apple-icon-60x60.png">
	  <link rel="apple-touch-icon" sizes="72x72" href="/Capstone.js-bookmarklet/icons/apple-icon-72x72.png">
	  <link rel="apple-touch-icon" sizes="76x76" href="/Capstone.js-bookmarklet/icons/apple-icon-76x76.png">
	  <link rel="apple-touch-icon" sizes="114x114" href="/Capstone.js-bookmarklet/icons/apple-icon-114x114.png">
	  <link rel="apple-touch-icon" sizes="120x120" href="/Capstone.js-bookmarklet/icons/apple-icon-120x120.png">
	  <link rel="apple-touch-icon" sizes="144x144" href="/Capstone.js-bookmarklet/icons/apple-icon-144x144.png">
	  <link rel="apple-touch-icon" sizes="152x152" href="/Capstone.js-bookmarklet/icons/apple-icon-152x152.png">
	  <link rel="apple-touch-icon" sizes="180x180" href="/Capstone.js-bookmarklet/icons/apple-icon-180x180.png">
	  <link rel="icon" type="image/png" sizes="192x192"  href="/Capstone.js-bookmarklet/icons/android-icon-192x192.png">
	  <link rel="icon" type="image/png" sizes="32x32" href="/Capstone.js-bookmarklet/icons/favicon-32x32.png">
	  <link rel="icon" type="image/png" sizes="96x96" href="/Capstone.js-bookmarklet/icons/favicon-96x96.png">
	  <link rel="icon" type="image/png" sizes="16x16" href="/Capstone.js-bookmarklet/icons/favicon-16x16.png">
	  <link rel="manifest" href="/Capstone.js-bookmarklet/icons/manifest.json">
	  <meta name="msapplication-TileImage" content="/Capstone.js-bookmarklet/icons/ms-icon-144x144.png">
  </head>
  <body>
	      <script>
	      	 
					var basicEditChanges = 'http://accounts.basicedit.com:8081/listChanges?hostname=' + window.location.hostname;
					var basicEditMasterId = '73595094-4ff9-4423-8e04-3ccc4023ec2e';
	      	

				  var xhr = createCORSRequest('GET', basicEditChanges);
				  if (!xhr) {
				    alert('CORS not supported');
				  }
				
				  // Response handlers.
				  xhr.onload = function() {
				    //var text = xhr.responseText;
				    var tempd = JSON.parse(xhr.responseText);
				    for(var i=0; i < tempd.length; i++) {
				    	editLookup[tempd[i].selector] = {oldContent: tempd[i].oldContent, newContent: tempd[i].newContent};
				    }
						realKickoff();
				  };
				
				  xhr.onerror = function() {
				    alert('Woops, there was an error making the request.');
				  };
				
				  xhr.send();
	      	
	      	
			function isIE () {
			  var myNav = navigator.userAgent.toLowerCase();
			  return (myNav.indexOf('msie') != -1) ? parseInt(myNav.split('msie')[1]) : false;
			}

			if (isIE () == 8) {
				var html5semantic = ['SECTION', 'ARTICLE', 'ASIDE', 'HEADER', 'FOOTER', 'NAV', 'FIGURE', 'FIGCAPTION', 'TIME', 'MARK', 'MAIN'];
				for(var i=0; i < html5semantic.length; i++) {
		      var ele = document.createElement(html5semantic[i]);
		      ele.style.display = 'block';
				}
				
			}

			var localEdits = {
			  "Item": {
			    "PageID": "http://williammahler.github.io/Capstone.js-bookmarklet/",
			    "edits": [
			      {
			        "selector": "H1,SECTION,BODY,HTML",
			        "newContent": " Hello from BasicEdit! ",
			        "oldContent": "Inline Disassembler Bookmarklet",
			      },
			      {
			        "selector": "H3,SECTION,BODY,HTML",
			        "newContent": "Derp",
			        "oldContent": "Usage",
			      }
			    ]
			  }
			}

			var editLookup = {};
			//editLookup['H1,SECTION,BODY,HTML'] = {oldContent: 'Inline Disassembler Bookmarklet', newContent: 'Hello from BasicEdit!'};
			//editLookup['H3,SECTION,BODY,HTML'] = {oldContent: 'Usage', newContent: 'Derp'};

			function getParents(main) {
				var arr = [];
				var loop = function (main) {
					do{
						if(main.nodeType == 3){
							continue;
						}

						arr.push(main.nodeName.toUpperCase());

						if(main.nodeName=='HTML'){
							return;
						}
					}
					while( main = main.parentNode);
				}
				loop(main);
				return arr.join();
			}

			function walkDOM(main) {
		    var arr = [];
		    var loop = function(main, realParent) {
	        do {
            if(main.nodeType == 3){
							var txt = main.textContent || main.nodeValue;
            	if(editLookup[getParents(main)] !== undefined && editLookup[getParents(main)].oldContent == txt){
            		if(main.textContent){
            			main.textContent = editLookup[getParents(main)].newContent;
            		}else{
            			main.nodeValue = editLookup[getParents(main)].newContent;
            		}
            	}
            	arr.push(getParents(main));
            }
            if(main.hasChildNodes())
            	loop(main.firstChild, main);
	        }
	        while (main = main.nextSibling);
		    }
		    loop(main, main.parentNode);

		    return arr;
			}

			var MutationObserver = (function () {
			  var prefixes = ['WebKit', 'Moz', 'O', 'Ms', '']
			  for(var i=0; i < prefixes.length; i++) {
			    if(prefixes[i] + 'MutationObserver' in window) {
			      return window[prefixes[i] + 'MutationObserver'];
			    }
			  }
			  return false;
			}());

    	function setupObserver(){
    		if(MutationObserver === undefined || !MutationObserver){
    			return;
    		}

				var observer = new MutationObserver(function(mutations) {
					mutations.forEach(function(mutation) {
						for (var i = 0; i < mutation.addedNodes.length; i++) {
							ele = mutation.addedNodes[i];
							if(ele.nodeType==3 && editLookup[getParents(ele)] !== undefined && editLookup[getParents(ele)].oldContent == ele.textContent){
				  			ele.textContent = editLookup[getParents(ele)].newContent;
							}
						}
					});
				});

				var observerConfig = {
					attributes: false,
					childList: true,
					subtree: true,
					characterData: false
				};

				var targetNode = document;
				observer.observe(targetNode, observerConfig);

    		document.getElementsByTagName('html')[0].style.display = '';
    	}
    	
    	function realKickoff(){
	    	document.getElementsByTagName('html')[0].style.display = 'none';
	
				(function(a){"function"==typeof define&&define.amd?define(a):window['onDomReady']=a()}(function(){"use strict";function s(a){if(!q){if(!b.body)return v(s);for(q=!0;a=r.shift();)v(a)}}function t(a){(o||a.type===d||b[h]===g)&&(u(),s())}function u(){o?(b[n](l,t,e),a[n](d,t,e)):(b[j](m,t),a[j](f,t))}function v(a,b){setTimeout(a,+b>=0?b:1)}function x(a){q?v(a):r.push(a)}var a=window,b=a.document,c=b.documentElement,d="load",e=!1,f="on"+d,g="complete",h="readyState",i="attachEvent",j="detachEvent",k="addEventListener",l="DOMContentLoaded",m="onreadystatechange",n="removeEventListener",o=k in b,p=e,q=e,r=[];if(b[h]===g)v(s);else if(o)b[k](l,t,e),a[k](d,t,e);else{b[i](m,t),a[i](f,t);try{p=null==a.frameElement&&c}catch(w){}p&&p.doScroll&&function y(){if(!q){try{p.doScroll("left")}catch(a){return v(y,50)}u(),s()}}()}return x.version="1.4.0",x.isReady=function(){return q},x}));
				walkDOM(document.getElementsByTagName('html')[0]);
				setupObserver();
				onDomReady( function() {
					walkDOM(document.getElementsByTagName('html')[0]);
					document.getElementsByTagName('html')[0].style.display = '';
				});
			}
			

    </script>

    <section class="page-header">

      <h1 class="project-name">Inline Disassembler Bookmarklet</h1>

      <h2 class="project-tagline"></h2>
      <a href="https://github.com/williammahler/Capstone.js-bookmarklet" class="btn">View on GitHub</a>
      <a href="https://github.com/williammahler/Capstone.js-bookmarklet/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/williammahler/Capstone.js-bookmarklet/tarball/master" class="btn">Download .tar.gz</a>
    </section>
    <section class="main-content">
      <h3>
<a id="welcome-to-github-pages" class="anchor" href="#welcome-to-github-pages" aria-hidden="true"><span class="octicon octicon-link"></span></a><p>Get started quickly by adding <a href="javascript:(function(){var script=document.createElement('SCRIPT');script.src='//s3.amazonaws.com/bookmarkletdisassembler/bookmarklet.js';document.body.appendChild(script);})()">Inline Disassembler</a> to your bookmarks.</p></h3>
			If you have any questions feel free to email me at williammahler84@gmail.com <br/>
			Additionally feel free to connect with me on <a href='https://www.linkedin.com/in/williammahler'>LinkedIn</a>.<br/>
<h3>
<a id="designer-templates" class="anchor" href="#designer-templates" aria-hidden="true"><span class="octicon octicon-link"></span></a>Usage</h3>

<p>Select any bytes you would like to disassemble on any page and then click the <a href="javascript:(function(){var script=document.createElement('SCRIPT');script.src='//s3.amazonaws.com/bookmarkletdisassembler/bookmarklet.js';document.body.appendChild(script);})()">Inline Disassembler</a> link or your bookmarklet. The disassembly engine will load for a moment and then prompt you to set configuration options before beginning disassembly.</p>
<br/>
<iframe width="853" height="480" src="https://www.youtube.com/embed/g7_33wVuCzI?rel=0" frameborder="0" allowfullscreen></iframe>


<h3>
<a id="creating-pages-manually" class="anchor" href="#creating-pages-manually" aria-hidden="true"><span class="octicon octicon-link"></span></a>Examples</h3>

<p>Source: <a href='https://www.exploit-db.com/exploits/38005/'>https://www.exploit-db.com/exploits/38005/ - SQL Server 2000/2005 SQLNS Unhandled Pointer Exploit</a> <br/>
<pre>
"\x64\x8B\x25\x00\x00\x00\x00\xeb\x07\x90\x90\x90"

'0C0C0C6C   64:8B25 00000000          MOV ESP,DWORD PTR FS:[0]
'0C0C0C73   EB 07                     JMP SHORT 0C0C0C7C
'0C0C0C75   90                        NOP
'0C0C0C76   90                        NOP
'0C0C0C77   90                        NOP
'12 bytes


"\x83\xEC\x24\x8B\xEC\x83\xC5\x30"

'0C0C0C7C   83EC 24                   SUB ESP,24
'0C0C0C7F   8BEC                      MOV EBP,ESP
'0C0C0C81   83C5 30                   ADD EBP,30
'8 bytes


'''''''''''''''''''''''''''''shellcode WinExec (win2k sp2)
"\xd9\xee\x9b\xd9\x74\x24\xf4\x5e\x83\xc6\x1a\x33\xc0\x50\x56\x68\x41\x41\x41\x41\x68\x16\x41\x86\x7c\xc3"

'D9EE            FLDZ
'9B              WAIT
'D97424 F4       FSTENV (28-BYTE) PTR SS:[ESP-C]
'5E              POP ESI
'83C6 1a                   ADD ESI,1a
'33C0                      XOR EAX,EAX
'50                        PUSH EAX
'56                        PUSH ESI
'68 F1F8807C               PUSH kernel32.ExitThread
'68 1641867C               PUSH kernel32.WinExec
'C3                        RETN
'''''''''''''''''''''''''''''main
</pre>
</p>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/williammahler/Capstone.js-bookmarklet">Capstone.js-bookmarklet</a> is maintained by <a href="https://github.com/williammahler">William Mahler</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>




            <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-67206807-1");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>
            <script type="text/javascript">
            /*
            	var gaJsHost = (("https:" == document.location.protocol) ? "https://" : "http://");
            	document.write(unescape("%3Cscript src='" + gaJsHost + "basicedit.com/changes.js' type='text/javascript'%3E%3C/script%3E"));
            */
          </script>

    <!-- <script src='//basicedit.com/changes.js'></script> -->
  </body>
</html>
